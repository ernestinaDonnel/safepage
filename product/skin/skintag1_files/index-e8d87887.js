function G(){import("data:text/javascript,")}const D=function(){const e=document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),C=function(n){return"https://cdn.myshopline.com/t/layout/plugin/2023062718202121/sales-countdown-plugin/"+n},g={},h=function(e,t,o){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=C(i),i in g)return;g[i]=!0;const c=i.endsWith(".css"),a=c?'[rel="stylesheet"]':"";if(!!o)for(let l=r.length-1;l>=0;l--){const p=r[l];if(p.href===i&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":D,c||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),c)return new Promise((l,p)=>{u.addEventListener("load",l),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};function O(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function y(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,o)}return t}function d(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?y(Object(t),!0).forEach(function(o){O(n,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(t,o))})}return n}function m(n){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(n)}function R(n){if(n&&m(n)==="object"){var e=[];return Object.keys(n).forEach(function(t){e.push("".concat(t,"=").concat(encodeURIComponent(n[t])))}),e.join("&")}return n}var _=function(e,t){var o=t.params?"".concat(e,"?").concat(R(t.params)):e;return fetch(o,d(d({},t),{},{headers:d({"content-type":"application/json"},t.headers),body:JSON.stringify((t==null?void 0:t.data)||t.body),credentials:"include"})).then(function(r){return r.status!==200?Promise.reject(r.json()):r.json()})},b=function(e,t){return typeof e<"u"?"".concat(e).concat(t):t},I=function(e){var t=e||{},o=t.baseURL;return{get:function(i,c){return _(b(o,i),d(d({},c),{},{method:"GET"}))},post:function(i,c){return _(b(o,i),d(d({},c),{},{method:"POST"}))}}};const P=I,E=()=>{window.magpieBridge||(window.magpieBridge={})};function w(){var e;return((e=window.Shopline)==null?void 0:e.themeTypeVersion)>=2.1}const T=960,j=750;function B(){return document.body.clientWidth||document.documentElement.clientWidth}function S(n){const e=B();return n===void 0?w()?e<T:e<j:e<n}const U=n=>{var e,t,o;return n?S(n):(o=(t=(e=window==null?void 0:window.SL_State)==null?void 0:e.get("request"))==null?void 0:t.is_mobile)!=null?o:S(n)},A=(n="")=>{var o,r;let e=n;(o=n==null?void 0:n.startsWith)!=null&&o.call(n,"http")||(e=location.origin+n);try{e=(r=new URL(e))==null?void 0:r.pathname}catch(i){}const t=e==null?void 0:e.split("/products/");if((t==null?void 0:t.length)>1)return t==null?void 0:t[(t==null?void 0:t.length)-1]},M="/api/product/products.json?handle=",N=(n,e,t)=>(E(),window.magpieBridge.productCacheData||(window.magpieBridge.productCacheData={}),fetch(M+n).then(o=>{o.status===200?o.json().then(r=>{r.products&&r.products.length&&(e==null||e(r.products[0])),e==null||e(null)}):t==null||t()},()=>{t==null||t()})),k=n=>{var t,o,r;if(!n)return Promise.resolve(null);if((o=(t=window.magpieBridge)==null?void 0:t.productCacheData)!=null&&o[n])return(r=window.magpieBridge.productCacheData)==null?void 0:r[n].promise;const e=new Promise(i=>{const c=function(){N(n,a=>{i(a)},()=>{var a,s;((a=window.magpieBridge.productCacheData.handle)==null?void 0:a.retryCount)<3?(window.magpieBridge.productCacheData.handle.retryCount++,setTimeout(()=>{c()},500)):((s=window.magpieBridge.productCacheData)==null||delete s.handle,i(null))})};c()});return window.magpieBridge.productCacheData[n]={promise:e,retryCount:0},e};E();var L=function(){return window.self!==window.top&&window.innerWidth<=(w()?960:750)},v=function(){return U()||L()};const W=async n=>{const e={pc:{container:document.getElementById("price-main-product-info"),outsideSlot:{className:"d-md-block",marginTop:"10px"},innerSlot:[{attr:"data-m-widget-scope",value:"countDownTimer"},{attr:"data-m-widget-type",value:"UNDER_PRICE"}]},mobile:{container:document.querySelector(".product__media-wrapper"),outsideSlot:{className:"d-md-none",marginTop:""},innerSlot:[{attr:"data-m-widget-scope",value:"countDownTimer"},{attr:"data-m-widget-type",value:"UNDER_PRICE"}]}};try{n&&Object.keys(e).forEach(t=>{var i;const o=document.createElement("div");o.className=e[t].outsideSlot.className,o.style.marginTop=e[t].outsideSlot.marginTop;const r=document.createElement("div");e[t].innerSlot.forEach(c=>{r.setAttribute(c.attr,c.value)}),r.setAttribute("data-spuseq",n),o.appendChild(r),(i=e[t].container)==null||i.appendChild(o)})}catch(t){}},V=P({baseURL:""}),$=n=>V.get("/api/sale/plugin/common/count_down_timer/get",{params:n});function f(n){window.Shopline?h(()=>import("./simpleBootstrap-chunk-5f8e7151.js"),["simpleBootstrap-chunk-5f8e7151.js","App-chunk-c4de1d99.js","assets/App.a4ceb452" + (document.dir === 'rtl' ?'-rtl':'') +".css"]).then(({default:e})=>{const{mount:t}=e;t(n)}):h(()=>import("./bootstrap-chunk-f5967cbe.js"),["bootstrap-chunk-f5967cbe.js","App-chunk-c4de1d99.js","assets/App.a4ceb452" + (document.dir === 'rtl' ?'-rtl':'') +".css"]).then(({default:e})=>{const{mount:t}=e;setTimeout(()=>{typeof t=="function"&&t(n)},0)})}const x=async()=>{var n,e,t,o;if(window.Shopline){let r=(o=(t=(e=(n=window.SL_State)==null?void 0:n.get)==null?void 0:e.call(n,"product"))==null?void 0:t.spu)==null?void 0:o.spuSeq;w()&&(r=(await k(A(window.location.href))).id,await W(r));const i=v(),c=document.querySelectorAll("[data-m-widget-scope=countDownTimer][data-m-widget-type=UNDER_PRICE]")[0];c&&$({spuSeq:c.dataset.spuseq}).then(a=>{const{data:s}=a||{};s&&(s==null?void 0:s.countDownTimerInfo)&&f({options:{productId:r,salesCountDownInfo:{...a.data,isMobile:i,isPreview:!1}}})})}else if(window.__SALES_MARKETING_PREVIEW_DATA__){const{previewData:r={},queryParams:i={}}=window.__SALES_MARKETING_PREVIEW_DATA__||{},c=(i==null?void 0:i.previewType)==="pc"||(i==null?void 0:i.previewType)==="mobile"?(i==null?void 0:i.previewType)==="mobile":v(),a=(i==null?void 0:i.language)||"en";f({options:{salesCountDownInfo:{...r,isMobile:c,isPreview:!0,language:a},isMobile:c,isPreview:!0,language:a,isOpen:!0}})}else f({options:{}})};x();export{h as _,G as __vite_legacy_guard,O as a,w as c};
